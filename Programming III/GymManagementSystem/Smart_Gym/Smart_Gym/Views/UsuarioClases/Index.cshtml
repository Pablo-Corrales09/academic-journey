@using Microsoft.AspNetCore.Identity
@model IEnumerable<Smart_Gym.Models.UsuarioClase>
@inject SignInManager<Usuario> SignInManager

@{
    ViewData["Title"] = "Index";
    var rolesPermitidos = new[] { "Administrador", "Entrenador" }; //Crea un arreglo con los roles permitidos para editar y eliminar rutinas.
    var tieneRol = rolesPermitidos.Any(rol => User.IsInRole(rol)); //Verifica si el usuario tiene alguno de los roles permitidos.
}

<div>
    <img src="https://t3.ftcdn.net/jpg/05/93/12/78/240_F_593127858_CtogB5P7ZlYzK4X1mMDtyVWtFBNdWBy1.jpg"
         alt="Smart Gym Banner"
         class="img-fluid w-100"
         style="max-height: 400px; border-radius: 14px;" />
</div>
<div class="d-flex justify-content-between align-items-center">
    <h1 class="text-center" style="font-size:30px; margin-top:35px;">Reserva de clases</h1>

    @if (SignInManager.IsSignedIn(User))
    {
    <a asp-action="Create" class="btn btn-primary"
    style="border-radius:14px;">
     <i class="bi bi-plus-circle me-2"></i>Crear reserva</a>
    }

</div>
<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Usuario)
            </th>
            <th>
                Clase
            </th>
            <th>
                Fecha y Hora
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Usuario.Nombre)
                    @Html.DisplayFor(modelItem => item.Usuario.Apellido)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ClaseRutina.Clase.Nombre)    
            </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ClaseRutina.Clase.FechaHora)
                </td>
            <td style="text-align: right;">
                    @if (SignInManager.IsSignedIn(User))
                    {
                        if (tieneRol)
                        {
                            

                            <a asp-action="Delete" asp-route-id="@item.IdUsuarioClase"
                               class="btn btn-danger" style="border-radius: 14px;">
                                <i class="bi bi-slash-circle me-2"></i>Cancelar reserva
                            </a>
                        }
                    }                  
            </td>
        </tr>
}
    </tbody>
</table>
